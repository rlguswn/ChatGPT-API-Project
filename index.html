<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>쉼표</title>
    <link href="./style.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div class="m-8 p-4 flex flex-col h-fit">
        <div class="">
            <!-- header -->
            <header>
                <img src="logo.jpg"></img>
                <p> ⓒ AAA Corp. </p>
            </header>

            <main>
                <!-- image area -->
                <div>
                    <img src="https://cdn.pixabay.com/photo/2017/12/15/13/51/polynesia-3021072_1280.jpg" alt="pixabay 이미지">
                </div>

                <!-- input area -->
                <div>
                    <form>
                        <div>
                            <div id="inputDate">
                                <span>여행 출발</span>
                                <input type="date">
                            </div>
                            <div id="inputDate">
                                <span>여행 도착</span>
                                <input type="date">
                            </div>
                        </div>
                        
                        <div id="inputText">
                            <p>여행 중 꼭 가보고 싶은 장소</p>
                            <input type="text" placeholder="텍스트를 입력해주세요.">
                        </div>

                        <div>
                            <p>차량 렌트 여부</p>
                            <div id="inputRadio">
                                <input type="radio" id="optionRent" name="rentGroup" value="optionRent">
                                <label for="optionRent">차량을 렌트할 예정입니다.</label><br>
                                <input type="radio" id="optionNotRent" name="rentGroup" value="optionNotRent">
                                <label for="optionNotRent">차량을 렌트하지 않을예정입니다.</label>
                            </div>
                        </div>

                        <div class="flex justify-end">
                            <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded-l-lg hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                전송
                            </button>
                        </div>
                    </form>
                </div>
            </main>
        </div>

        <!-- answer area -->
        <div class="m-4">
            <p class="mb-4 font-bold">여행일정</p>
            <textarea id="contents" placeholder="텍스트 입력" class="border-2 rounded-lg h-fit h-min-24 w-full py-2"></textarea>
        </div>
    </div>

    <script>
        let $input = document.querySelector('input')
        let $button = document.querySelector('button')
        let $contents = document.querySelector('#contents')

        let url = `https://estsoft-openai-api.jejucodingcamp.workers.dev/`

        // 학습 데이터
        let data = [{
            "role": "system",
            "content": "assistant는 제주 여행 전문가이다."
        },{
            "role": "user",
            "content": "제주 여행 일정을 만들어줘"
        }
        ,{
            "role": "user",
            "content": "제주 3박4일 여행 일정을 만들어줘. 결과는 문장은 제외하고 json형식으로 간단하게 해줘."
        }
    ]

        $button.addEventListener('click', e =>{
            e.preventDefault()
            userInputData = $input.value
            $input.value = ''
            $contents.innerText = ''

            data.push({
                "role": "user",
                "content": userInputData
            })

            chatGptAPI()
        })

        function chatGptAPI(){
            fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify(data),
                redirect: "follow",
            })
            .then(res => res.json())
            .then(res => {
                console.log(res)
                console.log(res.choices[0].message.content)
                $contents.innerText = res.choices[0].message.content
            })
        }
    </script>
</body>
</html>